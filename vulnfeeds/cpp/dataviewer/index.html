<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>CVE Conversion Data Viewer</title>
    <style>
        html,
        body {
            height: 100%;
        }

        section {
            display: flex;
        }

        article {
            display: flex;
            flex-flow: row wrap;
            flex: 1;
        }

        iframe {
            display: flex;
            width: 100%;
            flex: 1;
        }
    </style>
    <script type="text/javascript">
        function updateCve() {
            let CVEID = document.getElementsByName("CVEID")[0].value;
            let environment = document.getElementsByName("environment")[0].value;

            document.getElementsByName("nvd_source")[0].src = "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=" + CVEID;
            switch (environment) {
                case "staging":
                    document.getElementsByName("conversion_input")[0].src = "https://osv-test-cve-osv-conversion.storage.googleapis.com/parts/nvd/" + CVEID + ".nvd.json";
                    document.getElementsByName("osv_input")[0].src = "https://osv-test-cve-osv-conversion.storage.googleapis.com/osv-output/" + CVEID + ".json";
                    document.getElementsByName("osv_output")[0].src = "https://api.test.osv.dev/v1/vulns/" + CVEID;
                    break;
                case "production":
                    document.getElementsByName("conversion_input")[0].src = "https://cve-osv-conversion.storage.googleapis.com/parts/nvd/" + CVEID + ".nvd.json";
                    document.getElementsByName("osv_input")[0].src = "https://cve-osv-conversion.storage.googleapis.com/osv-output/" + CVEID + ".json";
                    document.getElementsByName("osv_output")[0].src = "https://api.osv.dev/v1/vulns/" + CVEID;
                    break;
            }
        }
    </script>
</head>

<body>
    <header>
        <h1>Andy's Handy Dandy CVE Conversion Inspector</h1>
        <p>
        <form name="cve_selector" onchange="updateCve()">
            <p>
                CVE ID: <input type="text" name="CVEID">
            </p>
            <p>
                <input type="radio" name="environment" value="staging" checked> Staging
            </p>
            <p>
                <input type="radio" name="environment" value="production"> Production
            </p>
        </form>
        </p>
    </header>
    <section>
        <article>
            The NVD source record
            <iframe title="The NVD source record"
                name="nvd_source"></iframe><!-- e.g. https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=CVE-2023-35862 -->
        </article>
        <article>
            <code>VersionInfo</code> JSON struct input to <code>combine-to-osv</code>
            <iframe title="The VersionInfo input to combine-to-osv"
                name="conversion_input"></iframe><!-- e.g. https://osv-test-cve-osv-conversion.storage.googleapis.com/parts/nvd/CVE-2023-35862.nvd.json -->
        </article>
        <article>
            The OSV record input to OSV.dev importer
            <iframe title="The OSV record input to OSV.dev importer"
                name="osv_input"></iframe><!-- e.g. https://osv-test-cve-osv-conversion.storage.googleapis.com/osv-output/CVE-2023-35862.json -->
        </article>
        <article>
            The resultant OSV record in OSV.dev (according to the API)
            <iframe title="The resultant OSV record in OSV.dev"
                name="osv_output"></iframe><!-- e.g. https://api.test.osv.dev/v1/vulns/CVE-2023-35862 -->
        </article>
    </section>
</body>

</html>